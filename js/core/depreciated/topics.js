function parse_single_topic(a){jQuery(document).trigger("parse_single_topic");a.split("_");Buleys.queues.pending_crawls.slice(0,1);Buleys.queues.pending_crawls.push(a)}
function update_topic_in_topics_database(a,b){jQuery(document).trigger("update_topic_in_topics_database");new_topics_transaction();b.topic_key=a;b.modified=new Date;if(typeof b.last_updated!="undefined")b.last_updated=new Date(parseInt(b.last_updated)*1E3);if(typeof b.updated!="undefined")b.updated=new Date(parseInt(b.updated)*1E3);if(typeof b.last_attempt!="undefined")b.last_attempt=new Date(parseInt(b.last_attempt)*1E3);var c=Buleys.objectStore.put(b);c.onsuccess=function(){Buleys.objectId=c.result};
c.onerror=function(){}}function get_page_topic_info(a,b){jQuery(document).trigger("get_page_topic_info");new_topics_transaction();var c=Buleys.objectStore.get(a+"_"+b);c.onsuccess=function(){typeof c.result!=="undefined"&&load_page_title_info(c.result)};c.onerror=function(){}}
function get_topics(){jQuery(document).trigger("get_topics");try{new_topics_transaction();Buleys.index=Buleys.objectStore.index("topic_key");var a=Buleys.index.openCursor();a.onsuccess=function(){var c=a.result;c&&c.length>=0&&jQuery.each(c,function(){})};request.onerror=function(){}}catch(b){}}function remove_topic(a){jQuery(document).trigger("remove_topic");new_topics_transaction();a=Buleys.objectStore["delete"](a);a.onsuccess=function(){delete Buleys.objectId};a.onerror=function(){}}
function add_or_update_topic(a,b){jQuery(document).trigger("add_or_update_topic");new_topics_transaction();if(typeof b=="undefined")b={};var c=Buleys.objectStore.get(a);c.onsuccess=function(){typeof c.result=="undefined"?add_topic_to_topics_database(a,b):update_topic_in_topics_database(a,b)};c.onerror=function(){}}
function add_topic_to_topics_database(a,b){jQuery(document).trigger("add_topic_to_topics_database");new_topics_transaction();if(typeof b=="undefined")b={};b.topic_key=a;b.modified=new Date;var c=Buleys.objectStore.add(b);c.onsuccess=function(){Buleys.objectId=c.result};c.onerror=function(){}}
function new_topics_transaction(){jQuery(document).trigger("new_topics_transaction");try{var a=Buleys.db.transaction(["topic"],IDBTransaction.READ_WRITE,1E3);a.oncomplete=function(){delete Buleys.objectStore};a.onabort=function(){};Buleys.objectStore=a.objectStore("topic")}catch(b){a=Buleys.db.setVersion(parseInt(Buleys.version,10));a.onsuccess=function(){Buleys.objectStore=Buleys.db.createObjectStore("topic",{keyPath:"topic_key"},true);Buleys.objectStore.createIndex("slug","slug",{unique:false});
Buleys.objectStore.createIndex("type","type",{unique:false});Buleys.objectStore.createIndex("last_updated","last_updated",{unique:false})};a.onerror=function(){}}};
