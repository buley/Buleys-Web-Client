function get_read(a,c,d,b,e){jQuery(document).trigger("get_read");if(typeof e=="undefined")e=false;typeof d=="undefined"||d==null||parseInt(d);typeof b=="undefined"||b==null?(new Date).getTime():parseInt(b);new_categories_transaction();Buleys.index=Buleys.objectStoreCategories.index("slug");a=IDBKeyRange.only(c);var i=Buleys.index.openCursor(a);i.onsuccess=function(){var f=i.result;if(f)f.length>1?jQuery.each(f,function(j,g){new_status_transaction();var h=Buleys.objectStore.get(g.link);h.onsuccess=
function(){if(typeof h.result!=="undefined"&&e!==true)jQuery("#"+g.link.replace(/[^a-zA-Z0-9-_]+/g,"")).length<=0&&get_item_raw(h.result.link);else typeof h.result=="undefined"&&e==true&&jQuery("#"+g.link.replace(/[^a-zA-Z0-9-_]+/g,"")).length<=0&&get_item_raw(g.link)}}):get_item(f.link)};i.onerror=function(){}}
function mark_item_as_read(a,c,d){jQuery(document).trigger("mark_item_as_read");new_status_transaction();a={link:a,topic_slug:c,topic_type:d,modified:(new Date).getTime()};var b=Buleys.objectStore.add(a);b.onsuccess=function(){Buleys.objectId=b.result};b.onerror=function(){}}
function new_status_transaction(){jQuery(document).trigger("new_status_transaction");try{var a=Buleys.db.transaction(["status"],IDBTransaction.READ_WRITE,1E3);a.oncomplete=function(){delete Buleys.objectStore};a.onabort=function(){};Buleys.objectStore=a.objectStore("status")}catch(c){a=Buleys.db.setVersion(parseInt(Buleys.version,10));a.onsuccess=function(){Buleys.objectStore=Buleys.db.createObjectStore("status",{keyPath:"link"},true);Buleys.objectStore.createIndex("topic_slug","topic_slug",{unique:false});
Buleys.objectStore.createIndex("topic_type","topic_type",{unique:false});Buleys.objectStore.createIndex("modified","modified",{unique:false})};a.onerror=function(){}}}function remove_item_from_read_database(a){jQuery(document).trigger("remove_item_from_read_database");new_status_transaction();a=Buleys.objectStore["delete"](a);a.onsuccess=function(){delete Buleys.objectId};a.onerror=function(){}}
function add_item_to_readstatus_database(a,c){jQuery(document).trigger("add_item_to_readstatus_database");if(typeof c=="undefined")c="unread";new_status_transaction();var d={link:a.link,status:c,modified:(new Date).getTime()},b=Buleys.objectStore.add(d);b.onsuccess=function(){Buleys.objectId=b.result};b.onerror=function(){}};
